# Shell脚本编程规范

1．绪论
本文提供了关于编程风格的一些指导意见（以shell脚本为例）。规定代码风格的目的在于使得程序代码具有更一致的外观，从而提高程序的可读性和可维护性。
程序员在进行代码的交叉审核之前，应当确保代码符合下面将要讨论的风格。
2.命名规则
给脚本起一个容易理解其功能的名字。
脚本名、变量名、函数名不超过20个字符；
命名只能使用英文字母，数字和下划线，只有一个英文单词时使用全拼，有多个单词时，使用下划线分隔，长度较长时，可以取单词前3～4个字母。
3.注释
注释的总体原则：不要为那些写的十分糟糕的代码写注释，重写它。
3.1编写注释的原则
1）	有助于对程序的阅读理解
必要时不能省略注释，也避免增加多余的注释；
2）	注释语言要简洁、准确、易懂
注释中不应该使用非常用缩写；
3）	保证注释与源代码的一致性
修改代码的同时应修改相应的注释 ；
4）	注释的位置要与被描述代码相邻；
5）	应放在代码的上方/右方，不可放在下方；与被注释代码保持相同的对齐/缩排格式。
3.2内容
1)	在脚本的第一行写上此脚本的解释器。
例：
用ksh解释：#!/usr/bin/ksh
用awk解释：#!/usr/bin/awk –f
	2)	用注释表明脚本的目的、用途、功能，以及使用方法。
3)	用注释指明函数的功能、参数。
3.3文件注释
	文件注释必须至少包含如下信息：
1）脚本名信息：避免更改脚本名为无法找到正确的文件
2）配置文件信息：配置文件名和脚本名一致，方便找到配置文件
3）版本号
4）更改后的时间
5）作者相关信息
6）该程序的作用，及注意事项
7）版本变更的简要说明

示例：
##---------------------------------------------
# @FileNm   fileMove.sh
# @Conf		 fileMove.conf
# @Version   0.1
# @Date     2009/02/10
# @Author    Tanlf
# @Despt     xxxxxxxxx….
# @ChgLog   xxxxx…
##-----------------------------------------------
3.4 函数注释
必须对函数的功能、输入参数有必要的注释，形式如下：
示例：
##---------------------------------------------
# @FunDesc   xxxxxxx…….
# @Param1	   xxxxx
# @Param2     xxxxx
#-----------------------------------------------
4.语法与语言
4.1统一的语法规则
1)	脚本能用-?选项显示Usage。
2)	需要参数的脚本，除了有-?选项外，当不带任何参数运行时也能显示Usage。
3)	环境变量全大写，单词之间用下划线分隔.
4)	用户变量全小写，单词之间用下划线分隔.
5)	函数名每个单词首字母大写，单词之间不用下划线.
4.2几种典型语句的格式
1）	for语句的格式：
for identifier [in word ...]
do
list…
done

2）	select语句格式：
select identifier [in word...]
do
list…
done

3）	case语句格式：
case word in
pattern [ | pattern] ... )
list…
;;
...
Esac

4）	if语句格式：
if list ;then
list…
elif list ;then
list…
else
list…
fi
嵌套的层次不应该超过5层，否则改用case。
5）	while/until语句格式：
while list
do
list
done

until list
do
list
done

6）	awk/sed语句格式：
awk args… ‘
BEGIN{
…
}
/pattern…/ {
…
}
END {
…
}
‘ file…
7）	脚本正常运行完毕返回0，异常退出返回非0。
5函数
5.1 参数判断
必须对函数的输入参数进行个数判断，如不正确，返回非0值。
5.2 函数返回值
函数正常执行完毕返回0，异常退出返回非0。
6 其他
1）对于程序中用到的文件，必须进行存在性判断。如不存在，进行告警提示。
2）执行完关键命令，如cp, mv, rm, rcp等之后，必须校验返回值。
3）设置用户账号，必须支持可配置。
4）在循环中使用远程操作命令，如remsh, rcp等时，一定要对输出进行重定向，否则循环执行一次就会退出。
